#include <stdio.h>
#include <stdlib.h>

/*정수를 비교하는 함수(오름차순)*/

int int_cmp(const int* a, const int* b)
{
	if (*a < *b)
		return -1;
	else if (*a > * b)
		return 1;
	else
		return 0;
}

int main(void)
{
	int i, nx, ky;
	int* x; /*배열의 첫번쨰 요소에 대한 포인터*/
	int* p; /*검색한 요소에 대한 포인터*/
	puts("bsearch 함수를 사용하여 검색");
	printf("요소 개수");
	scanf("%d", &nx);
	x = calloc(nx, sizeof(int)); /*요소의 개수가 nx인 int형 배열생성 */

	printf("오름차순으로 입력\n");
	printf("x[0]:");
	scanf("%d", &x[0]);
	for (i = 1; i < nx; i++)
	{
		do {
			printf("x[%d]:", i);
			scanf("%d", &x[i]);

		} while (x[i] < x[i - 1]); /*바로앞의 값보다 작으면 다시 입력*/
	}
	printf("검색값:");
	scanf("%d", &ky);
	p = bsearch(&ky,							/*검색값에 대한 포인터*/
		x,										/*배열*/
		nx,										/*요소의 개수*/
		sizeof(int),							/*요소의 크기*/
		(int(*)(const void*, const void*)) int_cmp /*비교 함수, int_cmp가 받는 인수의 자료형은 int*, bsearch 함수가 받는 비교함수의 인수는 void*입니다. 형 변환을 해야 합니다. */
	);
	if (p == NULL)
		puts("검색에 실패했슴둥");
	else
		printf("%d는 x[%d]에 있습니다. \n", ky, (int)(p - x));
	free(x);

	return 0;
}
/*1.첫번째 인수로 전달하는 매개변수는 키값입니다.(검색할 값이 저장된 객체에 대한 포인터). 이 프로그램에서는 키 값이 변수 ky에 저장되어 있으므로 &ky를 전달합니다.
  2. 두번째 인수로 전달하는 매개변수는 배열의 포인터입니다. 이 프로그램에서는 검색 대상인 배열 x인 포인터(x)를 전달합니다.
  3. 세 번째 인수로 전달하는 매개변수는 배열의 요소 개수입니다. 이 프로그램에서는 nx입니다.
  4. 네 번째 인수로 전달하는 매개변수는 배열의 요소 크기입니다. 이프로그램에서는 검색대상인 배열x의 요소의 자료형이 int형이므로 sizeof(int)를 전달합니다
  5. 비교 함수 -> 함수의 포인터형인 다섯번째 인수.
	이진 검색의 검색 과정에는 검색하는 키값과 배열의 요솟값을 비교하여 대소 관계를 판단하는 과정이 포함됨.
	그런데 대소 관계를 판단하는 방법은 요소의 자료형마다 다름. 요소의 자료형은 정수일 수도 있고, 문자열이나 구조체일 수도 있음.
	그러므로 두 값을 비교하고 난 다음의 어떤 값을 반환하는 비교 함수는 사용자가 직접 작성해야 합니다. 따라서 bsearch 함수는 다섯 번째 매개변수로 이 비교함수에 대한 포인터를 전달
	bsearch
	1. 첫번째 인수가 가리키는 값이 더 작으면 음수 반환.
	2. 첫번째 인수가 가리키는 값과 두번째 인수가 가리키는 값이 같으면 0 반환.
	3. 첫번째 인수가 가리키는 값이 더 크면 양수 반환*/
